---
- name: Machine setup
  hosts: localhost
  connection: local
  gather_facts: true

  tasks:
    - name: Ensure custom zsh profile is loaded
      ansible.builtin.lineinfile:
        path: "{{ ansible_env.HOME }}/.zshrc"
        line: "source ~/.zsh_profile"
        create: yes

    - name: Download zellij plugins
      script: ./download_zellij_plugins.sh

    - name: Download bat theme
      script: ./download_bat_theme.sh

    - name: Install Flatpaks
      community.general.flatpak:
        name:
          - app.zen_browser.zen
          - com.brave.Browser
          - com.spotify.Client
          - org.wezfurlong.wezterm
      when: ansible_distribution == "Fedora"

    - name: Copy Zen Browser theme
      script: ./zen_browser.py
      when: ansible_distribution == "Fedora"
